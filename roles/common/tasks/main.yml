---
# This playbook contains common plays that will be run on all nodes.

- lineinfile: >
    dest=/etc/sysconfig/network
    regexp=^HOSTNAME=
    line=HOSTNAME={{ inventory_hostname }}{{ hostname_suffix }}
- hostname: name={{ inventory_hostname }}{{ hostname_suffix }}


- name: "Build hosts file"
  lineinfile: >
    dest=/etc/hosts
    regexp='^{{ hostvars[item].ansible_default_ipv4.address }}'
    line='{{ hostvars[item].ansible_default_ipv4.address }} {{ item }} {{ item }}{{ hostname_suffix }}'
    state=present
  when: hostvars[item].ansible_default_ipv4.address is defined
  with_items: groups['all']
